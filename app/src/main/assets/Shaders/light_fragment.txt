#version 300 es
precision highp float;

struct Material
{
    vec3 color;
    vec3 specularColor;
    float shininess;
};

struct DirectionalLight
{
    vec3 direction;
    vec3 specularColor;
    vec3 color;
};

out vec4 col;
in vec2 coords;
in vec3 norms;
in vec3 fragpos;

uniform vec3 ambientLight;
uniform DirectionalLight dirLight;
uniform Material material;
uniform sampler2D myTexture;
uniform vec3 cameraPosition;


void main()
{

    vec3 texColor = texture(myTexture,coords).xyz;

    //Diffuse lighting
    vec3 diffuse;
    float d = max(dot(normalize(norms),-normalize(dirLight.direction)),0.0);
    diffuse = dirLight.color * d;

    //Specular lighting
    vec3 specular;
    vec3 fragToCam = normalize(cameraPosition - fragpos);

    vec3 ref = reflect(normalize(dirLight.direction), normalize(norms));
    d = pow(max(dot(normalize(ref), fragToCam),0.0f),material.shininess);

    specular = d * material.specularColor ;

    vec3 total = texColor * material.color * (ambientLight + diffuse + specular);

    col = vec4(total,1.0);

}